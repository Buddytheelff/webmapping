<!DOCTYPE html>
<html>


<head>
  <meta charset="utf-8">
  <title>A Leaflet map! Stephen</title>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <link rel="stylesheet", href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css">
  <script src="Bike_Thefts_sample.js"></script>
  <style>
  #mapId{ width: 900px; height: 500px; }
  </style>
</head>
<body>

  <div id="mapId"></div>

  <script>
    "use strict";

    function pointToCircle(feature, latlng) {

      let fillColorVar = "";

      if (Number(feature.properties["Theft Hour"]) > 6 && Number(feature.properties["Theft Hour"]) <= 16) {
        fillColorVar = "yellow";
      } else if (Number(feature.properties["Theft Hour"]) > 22 || Number(feature.properties["Theft Hour"]) <= 6) {
        fillColorVar = "blue";
      } else {
        fillColorVar = "orange";
      }

      let geojsonMarkerOptions = {
        radius: 8,
        fillColor: fillColorVar,
        color: "#000",
        weight: 1,
        opacity: 1,
        fillOpacity: 0.8
      };

      let circleMarker = L.circleMarker(latlng, geojsonMarkerOptions);

      return circleMarker;
    }

  function addPopups(feature, layer) {
    // this is statement used to check whether the feature has a property named "Location"
    if (feature.properties && feature.properties.Location) {
      layer.bindPopup("<dl><dt>Address: " + feature.properties.Location + "</dt>" +
                      "<dt>Stolen_value: " + feature.properties["Stolen Value"] + "</dt></dl>")
    }
  }

  function filterStolenValue(feature) {
    if (feature.properties["Stolen Value"] > 200) {
      return true
    }
  }

  /* initialize the map. 
  setView method: Sets the view of the map (geographical center and zoom) with the given animation options.

  setView( <LatLng> center, <Number> zoom?, <zoom/pan options> options? )
  */
  
  let map = L.map('mapId')//.setView([39.999, -75.160616], 12);

  //replace the code below from the Plain JavaScript from the map style you choose
  //at http://leaflet-extras.github.io/leaflet-providers/preview/

  let OpenStreetMap_BlackAndWhite = L.tileLayer('https://api.mapbox.com/styles/v1/invictusying/ckt1snsq41ets17lkz920ak9i/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiaW52aWN0dXN5aW5nIiwiYSI6ImNrMWs4MmJ4dDI4d3gzaXMxZjR6bDQxZ2wifQ.TuI7ofr_DGyXW7ItqqRCvw', {
    maxZoom: 18,
    attribution: '&copy; <a href=”https://www.mapbox.com/about/maps/”>Mapbox</a> &copy; <a href=”http://www.openstreetmap.org/copyright”>OpenStreetMap</a>'
  });
  
  //change the varialbe "OpenStreetMap_BlackAndWhite" according to the map style you choose
  //It is the varialbe between "let" and "= L.titleLayer(..."  in Line 27 in this script
  OpenStreetMap_BlackAndWhite.addTo(map);

  let bikesLayerGroup = L.geoJSON(bikeThefts, {
    onEachFeature: addPopups,
    pointToLayer: pointToCircle,
    // Method 1: call function
    filter: filterStolenValue
    // Method 2: inline function
    // filter: function(feature, layer) {
    //   if (feature.properties["Stolen Value"] > 200) {
    //     return true;
    //   };
    // };
  });
  //I have removed this line:
  //bikesLayerGroup.addTo(map);
  map.addLayer(bikesLayerGroup);
  map.fitBounds(bikesLayerGroup.getBounds());

  /*
  L.geoJSON(bikeThefts, {
    onEachFeature: addPopups
  }).addTo(map);
  */
  </script>
</body>
</html>